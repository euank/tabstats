<!DOCTYPE html>
<html>
<head>
<title>About Tabs</title>
<script src="resource://tabstats/template.js"></script>
<script src="resource://tabstats/abouttabs.js"></script>
<style type="text/css">
body {
  margin: 0;
}

h1 {
  margin: 0;
  flex: 1 1 auto;
  font-size: 1.8em;
}

#top {
  background: lightgray;
  margin: 0;
  padding: 0.2em 0.8em;
  display: flex;
}

#bar {
  background: #e0e0e0;
  padding: 0.1em 0.5em;
  border-top: 1px solid gray;
  border-bottom: 1px solid gray;
}

#bar span {
  font: -moz-list;
  color: #313739;
  padding: 0 .7em 0 .3em;
}

image {
  width: 16px;
  min-width: 16px; /* Somehow this is required in the cases where text overflows in the title */
  height: 16px;
  margin-right: .2em;
}

#stats {
  white-space: nowrap;
}

li > div {
  display: flex;
}

li {
  margin: .3em 0;
}

ul.host, ul.address {
  list-style-type: none;
  -moz-padding-start: 20px;
}

.title {
  overflow: hidden;
  text-overflow: ellipsis;
}

.url {
  margin-left: 16px;
  padding-left: .2em;
  font-size: .8em;
}

.actions * {
  padding-left: .3em;
}

li.schemes span {
  margin-right: 1em;
}
</style>
</head>
<body>

<template id="main">
  <div id="top">
    <h1>${tabCount}_tab</h1>
    <button onclick="refresh()">Refresh</button>
  </div>
  <div id="bar">
    <span>${windowsCount}_window</span>
    <span>${tabGroupsCount}_tab_group</span>
  </div>
  <ul id="stats" template="group" template-data="${groups}">
    <li>${loadedTabs}_tab ${loadedTabs}?(has|have) been loaded</li>
    <li class="schemes" template="schemes" template-data="${schemes.byKey}"></li>
    <li template-if="${blankTabs}">${blankTabs}_empty_tab</li>
  </ul>
</template>

<template id="schemes">
  <span>${value} ${key}:</span>
</template>

<template id="group">
  <li>${length}_unique_${what}
    <ul template-if="${numDupes}">
      <li>${numDupes}_${what} in more than 1 tab:
        <span class="actions">
          <a href="#" onclick="${dupes.dedup}" template-if="${dupes.dedup}">[Dedup]</a>
          <a href="#" onclick="${dupes.close}">[Close]</a>
        </span>
        <ul class="${what}" template="item" template-data="${dupes.byLength}"></ul>
      </li>
      <li>${numUnique}_other_${what}
        <ul class="${what}" template-delay="item" template-data="${unique.byLastAccessed}"></ul>
      </li>
    </ul>
    <ul class="${what}" template-if="${!numDupes}" template-delay="item" template-data="${unique.byLastAccessed}"></ul>
  </li>
</template>

<template id="item">
  <li>
    <div>
      <xul:image validate="never" template-if="${favicon}" src="${favicon}"></xul:image>
      <xul:image validate="never" template-if="${!favicon}" src="chrome://mozapps/skin/places/defaultFavicon.png"></xul:image>
      <div class="title" template-if="${title}">${title}</div>
      <div class="title" template-if="${!title}">${url}</div>
      <div class="actions">
        <span template-if="${length}">(${length}_tab)</span>
        <a href="#" onclick="${dedup}" template-if="${dedup}">[Dedup]</a>
        <a href="#" onclick="${close}">[Close]</a>
      </div>
    </div>
    <div class="url" template-if="${url && title}">${url}</div>
  </li>
</template>

<template id="duplicates">
  <li>
    <div>
      <xul:image validate="never" src="${favicon}"></xul:image>
      <div class="title">${title}</div>
      <div class="actions">
        (${num_tabs}_tab)
        <a href="#" onclick="${dedup}" template-if="${dedup}">[Dedup]</a>
        <a href="#" onclick="${close}">[Close]</a>
      </div>
    </div>
    <div class="url">${url}</div>
  </li>
</template>

</body>
</html>
